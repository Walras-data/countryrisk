"0",""
"0","### Heatmap currency crisis by month"
"0",""
"0","countries = unique(base$`ISO2 Code`)"
"0","countries = as.data.frame(countries)"
"0","countries$n = rep(1:7, each=6)"
"0","countries$n2 = rep(seq(1,6,1), times = 7)"
"0",""
"0","countries$`ISO2 Code` = countries$countries"
"0",""
"0",""
"0","stack = merge(base, countries, by = ""ISO2 Code"")"
"0","stack$ano = substr(stack$year, start = 1, stop = 4)"
"0","stack$mes = substr(stack$year, start = 6, stop = 7)"
"0",""
"0","stacked = stack %>% select(year, dummy)"
"0",""
"0",""
"0","stacked = aggregate(x = stacked$dummy, "
"0","                    by = list(stacked$year), "
"0","                    FUN = sum)"
"0",""
"0","stacked$ano = as.numeric(substr(stacked$Group.1, start = 1, stop = 4))"
"0","stacked$mes = substr(stacked$Group.1, start = 6, stop = 7)"
"0",""
"0",""
"0","timeheat <- ggplot(stacked, aes(ano, mes, fill = x)) + "
"0","  geom_tile(colour=""gray10"", size=1) +"
"0","  scale_y_discrete(labels=month.abb)+"
"0","  geom_text(aes(label=x), size=5, color = ""gray30"") +"
"0","  xlab("""") + "
"0","  ylab("""") +"
"0","  ggtitle(""Currency crisis by month"") +"
"0","  theme("
"0","    plot.title = element_text(color=""black"",hjust=0,vjust=1, size=rel(2)),"
"0","    plot.background = element_rect(fill=""white""),"
"0","    panel.background = element_rect(fill=""white""),"
"0","    panel.border = element_rect(fill=NA,color=""white"", size=0.5, linetype=""solid""),"
"0","    panel.grid.major = element_blank(),"
"0","    panel.grid.minor = element_blank(),"
"0","    axis.line = element_blank(),"
"0","    axis.ticks = element_blank(), "
"0","    axis.text = element_text(color=""black"", size=rel(1.5)),"
"0","    axis.text.y  = element_text(hjust=1),"
"0","    legend.text = element_text(color=""black"", size=rel(1.3)),"
"0","    legend.background = element_rect(fill=""white""),"
"0","    legend.position = ""bottom"","
"0","    legend.title=element_blank()"
"0","  )"
"0",""
"0","ggplotly(timeheat)"
